task :generate_metagrammar_data do
  $: << File.join(File.dirname(__FILE__), "lib")
  require "jetpeg"
  
  input = IO.read File.join(File.dirname(__FILE__), "lib/jetpeg/compiler/metagrammar.jetpeg")
  data = JetPEG::Compiler.parse input, :grammar
  
  File.open(File.join(File.dirname(__FILE__), "lib/jetpeg/compiler/metagrammar.data"), "wb") do |io|
    io.write Marshal.dump(data)
  end
end